<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Week 8: Advanced Pandas & Data Cleaning | Python Course</title>
    <meta name="description" content="Interactive lesson on Advanced Pandas techniques: Merging, GroupBy, Pivot Tables, and robust Data Cleaning.">
    <link rel="icon" type="image/png" href="../assets/brands/favicon-straydog.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;800&family=Orbitron:wght@700;900&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
           CSS CUSTOM PROPERTIES (Variables) - CONSISTENT THEME
           ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        :root {
            --bg-dark: #0a0e27;
            --bg-medium: #1a1f3a;
            --bg-light: #2a2f4a;
            --accent-cyan: #00f0ff;
            --accent-magenta: #ff00ff;
            --accent-yellow: #ffff00;
            --accent-green: #00ff41;
            --accent-orange: #ff6b35;
            --accent-red: #ff3366;
            --accent-blue: #4da6ff;
            --text-primary: #e0e0e0;
            --text-secondary: #a0a0a0;
            --level-bad: #ff3366;
            --level-novice: #ff9f43;
            --level-intermediate: #4da6ff;
            --level-best: #00ff41;
            --shadow-glow: 0 0 20px rgba(0, 240, 255, 0.3);
            --shadow-glow-green: 0 0 20px rgba(0, 255, 65, 0.3);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Space Mono', monospace;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0, 240, 255, 0.03) 2px, rgba(0, 240, 255, 0.03) 4px);
            pointer-events: none;
            z-index: 1;
            animation: scanlines 8s linear infinite;
        }

        @keyframes scanlines {
            0% { transform: translateY(0); }
            100% { transform: translateY(4px); }
        }

        header {
            position: relative;
            z-index: 10;
            padding: 2rem;
            text-align: center;
            background: linear-gradient(135deg, var(--bg-medium) 0%, var(--bg-dark) 100%);
            border-bottom: 3px solid var(--accent-cyan);
            box-shadow: 0 4px 20px rgba(0, 240, 255, 0.2);
        }

        h1 {
            font-family: 'Orbitron', monospace;
            font-size: 2.5rem;
            font-weight: 900;
            background: linear-gradient(45deg, var(--accent-cyan), var(--accent-magenta));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { filter: drop-shadow(0 0 5px var(--accent-cyan)); }
            to { filter: drop-shadow(0 0 20px var(--accent-magenta)); }
        }

        .subtitle { font-size: 1.1rem; color: var(--accent-green); font-weight: 600; }
        
        .week-badge {
            display: inline-block;
            background: var(--accent-magenta);
            color: var(--bg-dark);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            margin-top: 0.5rem;
        }

        .progress-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 4px; background: var(--bg-medium); z-index: 1000;
        }
        .progress-bar {
            height: 100%; background: linear-gradient(90deg, var(--accent-cyan), var(--accent-magenta)); width: 0%; transition: width 0.3s ease; box-shadow: var(--shadow-glow);
        }
        .xp-bar {
            position: fixed; top: 20px; right: 20px; background: var(--bg-medium); padding: 1rem; border-radius: 8px; border: 2px solid var(--accent-cyan); z-index: 100; min-width: 220px; box-shadow: var(--shadow-glow);
        }
        .xp-label { font-size: 0.85rem; color: var(--accent-yellow); margin-bottom: 0.5rem; font-weight: 700; }
        .xp-progress { width: 100%; height: 20px; background: var(--bg-dark); border-radius: 10px; overflow: hidden; position: relative; }
        .xp-fill { height: 100%; background: linear-gradient(90deg, var(--accent-green), var(--accent-cyan)); width: 0%; transition: width 0.5s ease; }
        .xp-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 0.75rem; font-weight: 700; color: var(--text-primary); text-shadow: 1px 1px 2px rgba(0,0,0,0.8); }

        .container { display: flex; max-width: 1400px; margin: 0 auto; position: relative; z-index: 2; }
        .sidebar { width: 300px; position: sticky; top: 20px; height: calc(100vh - 40px); padding: 2rem 1rem; background: var(--bg-medium); border-right: 2px solid var(--accent-cyan); overflow-y: auto; }
        .nav-title { font-size: 0.9rem; color: var(--accent-yellow); margin-bottom: 1rem; font-weight: 700; text-transform: uppercase; }
        .nav-item { padding: 0.75rem 1rem; margin-bottom: 0.5rem; cursor: pointer; border-left: 3px solid transparent; transition: all 0.3s ease; font-size: 0.95rem; background: var(--bg-dark); border-radius: 4px; }
        .nav-item:hover { border-left-color: var(--accent-cyan); background: var(--bg-light); transform: translateX(5px); }
        .nav-item.active { border-left-color: var(--accent-magenta); background: var(--bg-light); color: var(--accent-cyan); box-shadow: var(--shadow-glow); }
        .nav-item.completed::after { content: ' ‚úì'; color: var(--accent-green); float: right; }
        
        .main-content { flex: 1; padding: 2rem; min-height: 100vh; }
        .section { display: none; animation: fadeIn 0.5s ease; }
        .section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        h2 { font-family: 'Orbitron', monospace; font-size: 2rem; color: var(--accent-cyan); margin-bottom: 1rem; text-transform: uppercase; letter-spacing: 1px; }
        h3 { font-family: 'Orbitron', monospace; font-size: 1.5rem; color: var(--accent-magenta); margin: 2rem 0 1rem 0; }
        p { margin-bottom: 1rem; color: var(--text-secondary); line-height: 1.8; }

        .skill-progression { margin: 2rem 0; background: var(--bg-medium); border-radius: 12px; overflow: hidden; border: 2px solid var(--bg-light); }
        .skill-tabs { display: flex; background: var(--bg-dark); border-bottom: 2px solid var(--bg-light); flex-wrap: wrap; }
        .skill-tab { flex: 1; min-width: 120px; padding: 1rem; cursor: pointer; text-align: center; font-weight: 700; font-size: 0.85rem; transition: all 0.3s ease; border: none; background: transparent; color: var(--text-secondary); font-family: 'Space Mono', monospace; position: relative; }
        .skill-tab::after { content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 3px; background: transparent; transition: background 0.3s ease; }
        .skill-tab:hover { background: var(--bg-light); }
        .skill-tab.active { color: var(--text-primary); }
        .skill-tab[data-level="bad"] { border-top: 3px solid var(--level-bad); }
        .skill-tab[data-level="novice"] { border-top: 3px solid var(--level-novice); }
        .skill-tab[data-level="intermediate"] { border-top: 3px solid var(--level-intermediate); }
        .skill-tab[data-level="best"] { border-top: 3px solid var(--level-best); }
        .skill-tab[data-level="bad"].active::after { background: var(--level-bad); }
        .skill-tab[data-level="novice"].active::after { background: var(--level-novice); }
        .skill-tab[data-level="intermediate"].active::after { background: var(--level-intermediate); }
        .skill-tab[data-level="best"].active::after { background: var(--level-best); }
        .skill-tab-icon { display: block; font-size: 1.2rem; margin-bottom: 0.25rem; }
        .skill-content { display: none; padding: 0; animation: fadeIn 0.3s ease; }
        .skill-content.active { display: block; }

        .code-container { background: var(--bg-dark); border: 2px solid var(--accent-cyan); border-radius: 8px; margin: 1.5rem 0; overflow: hidden; box-shadow: var(--shadow-glow); }
        .code-container.level-bad { border-color: var(--level-bad); box-shadow: 0 0 15px rgba(255, 51, 102, 0.2); }
        .code-container.level-novice { border-color: var(--level-novice); box-shadow: 0 0 15px rgba(255, 159, 67, 0.2); }
        .code-container.level-intermediate { border-color: var(--level-intermediate); box-shadow: 0 0 15px rgba(77, 166, 255, 0.2); }
        .code-container.level-best { border-color: var(--level-best); box-shadow: var(--shadow-glow-green); }

        .code-header { background: var(--bg-medium); padding: 0.75rem 1rem; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--accent-cyan); flex-wrap: wrap; gap: 0.5rem; }
        .code-header-left { display: flex; align-items: center; gap: 0.75rem; flex-wrap: wrap; }
        .code-label { color: var(--accent-yellow); font-weight: 700; font-size: 0.9rem; }
        .level-badge { padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }
        .level-badge.bad { background: var(--level-bad); color: white; }
        .level-badge.novice { background: var(--level-novice); color: var(--bg-dark); }
        .level-badge.intermediate { background: var(--level-intermediate); color: var(--bg-dark); }
        .level-badge.best { background: var(--level-best); color: var(--bg-dark); }
        .semantic-label { font-size: 0.8rem; color: var(--text-secondary); padding: 0.25rem 0.5rem; background: var(--bg-dark); border-radius: 4px; }

        pre { padding: 1.5rem; overflow-x: auto; font-family: 'JetBrains Mono', monospace; font-size: 0.9rem; line-height: 1.7; background: var(--bg-dark); color: var(--text-primary); margin: 0; }
        .keyword { color: var(--accent-magenta); font-weight: 600; }
        .string { color: var(--accent-green); }
        .function { color: var(--accent-cyan); }
        .comment { color: #6a9955; font-style: italic; }
        .number { color: var(--accent-yellow); }
        .class-name { color: var(--accent-orange); font-weight: bold; }
        .builtin { color: var(--accent-blue); }
        .decorator { color: var(--accent-yellow); }

        .output { background: #000; color: var(--text-primary); padding: 0; font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; border-top: 1px solid var(--bg-light); max-height: 0; overflow: hidden; transition: all 0.3s ease; }
        .output.show { padding: 1rem; max-height: 300px; overflow-y: auto; }
        .output-label { color: var(--text-secondary); font-size: 0.75rem; text-transform: uppercase; margin-bottom: 0.5rem; display: block; }

        .run-button { background: var(--accent-green); color: var(--bg-dark); border: none; padding: 0.4rem 1rem; border-radius: 4px; font-family: 'Space Mono', monospace; font-weight: 700; cursor: pointer; transition: all 0.2s; font-size: 0.8rem; }
        .run-button:hover { transform: translateY(-2px); box-shadow: 0 0 10px var(--accent-green); }
        .run-button:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

        .explanation-box { background: var(--bg-medium); border-radius: 8px; padding: 1.25rem; margin: 1rem 0; border-left: 4px solid var(--accent-blue); }
        .explanation-box.tip { border-left-color: var(--level-best); }
        .explanation-box.warning { border-left-color: var(--level-bad); }
        .explanation-box.info { border-left-color: var(--accent-cyan); }
        .explanation-title { font-weight: 700; margin-bottom: 0.5rem; color: var(--text-primary); display: flex; align-items: center; gap: 0.5rem; }

        .objectives-box { background: linear-gradient(135deg, rgba(0, 240, 255, 0.1), var(--bg-medium)); border: 2px solid var(--accent-cyan); border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; }
        .objectives-list li { padding: 0.5rem 0; padding-left: 1.5rem; position: relative; }
        .objectives-list li::before { content: '‚ñ∏'; position: absolute; left: 0; color: var(--accent-green); font-weight: bold; }

        .playground { background: var(--bg-medium); border: 2px solid var(--accent-yellow); border-radius: 8px; padding: 1.5rem; margin: 2rem 0; }
        .playground-header { display: flex; justify-content: space-between; margin-bottom: 1rem; }
        .playground-title { font-weight: 700; color: var(--accent-yellow); }
        textarea { width: 100%; height: 150px; background: var(--bg-dark); color: var(--text-primary); border: 1px solid var(--bg-light); padding: 1rem; font-family: 'JetBrains Mono', monospace; border-radius: 4px; resize: vertical; }

        .nav-buttons { display: flex; justify-content: space-between; margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--bg-light); }
        .nav-btn { background: var(--bg-medium); color: var(--text-primary); border: 2px solid var(--accent-cyan); padding: 1rem 2rem; border-radius: 8px; cursor: pointer; font-family: 'Space Mono', monospace; font-weight: 700; transition: all 0.3s ease; }
        .nav-btn:hover { background: var(--accent-cyan); color: var(--bg-dark); }
        .nav-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .complete-btn { background: linear-gradient(135deg, var(--accent-green), var(--accent-cyan)); color: var(--bg-dark); border: none; width: 100%; margin-top: 2rem; }

        .achievement { position: fixed; bottom: 20px; right: 20px; background: linear-gradient(135deg, var(--bg-medium), #000); border: 2px solid var(--accent-yellow); border-radius: 12px; padding: 1.5rem; width: 300px; transform: translateY(150%); transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 2000; box-shadow: 0 0 30px rgba(255, 255, 0, 0.3); text-align: center; }
        .achievement.show { transform: translateY(0); }
        .achievement-icon { font-size: 3rem; margin-bottom: 0.5rem; animation: bounce 1s infinite alternate; }
        @keyframes bounce { from { transform: translateY(0); } to { transform: translateY(-10px); } }

        @media (max-width: 968px) {
            .container { flex-direction: column; }
            .sidebar { width: 100%; height: auto; position: relative; }
            .xp-bar { position: relative; top: 0; right: 0; margin: 1rem; }
        }
    </style>
</head>
<body class="sd-watermark">
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <div class="xp-bar">
        <div class="xp-label">üìä Progress</div>
        <div class="xp-progress">
            <div class="xp-fill" id="xpFill"></div>
            <div class="xp-text" id="xpText">0 / 5 Topics</div>
        </div>
    </div>

    <header>
        <h1>üêº Advanced Pandas</h1>
        <p class="subtitle">Mastering Data Cleaning & Transformation</p>
        <span class="week-badge">WEEK 8</span>
    </header>

    <div class="container">
        <aside class="sidebar">
            <nav class="nav-section">
                <div class="nav-title">üìñ Topics</div>
                <div class="nav-item active" data-section="intro">Introduction</div>
                <div class="nav-item" data-section="merging">Merging & Joining</div>
                <div class="nav-item" data-section="groupby">Grouping & Aggregation</div>
                <div class="nav-item" data-section="missing">Missing Data</div>
                <div class="nav-item" data-section="strings">String Operations</div>
                <div class="nav-item" data-section="cheatsheet">Cheat Sheet</div>
            </nav>
        </aside>

        <main class="main-content">
            <!-- INTRO -->
            <section id="intro" class="section active">
                <h2>üßπ The Art of Data Cleaning</h2>
                
                <div class="objectives-box">
                    <div class="objectives-title">üéØ Learning Objectives</div>
                    <ul class="objectives-list">
                        <li>Combine multiple datasets using <code>merge</code> and <code>concat</code></li>
                        <li>Perform powerful aggregations with <code>groupby</code></li>
                        <li>Handle missing data (`NaN`) strategies</li>
                        <li>Clean messy text data using vectorised string methods</li>
                        <li>Chain methods for readable data pipelines</li>
                    </ul>
                </div>

                <div class="vocab-list">
                    <div class="vocab-title">üìö Key Vocabulary</div>
                    <div class="vocab-grid">
                        <div class="vocab-item">
                            <span class="vocab-term">Merge</span>
                            <span class="vocab-definition">Combining two DataFrames based on common column(s) (like SQL JOIN). Types: inner, left, right, outer.</span>
                        </div>
                        <div class="vocab-item">
                            <span class="vocab-term">Concat</span>
                            <span class="vocab-definition">Stacking DataFrames vertically (rows) or horizontally (columns) without matching keys. Useful for combining similar datasets.</span>
                        </div>
                        <div class="vocab-item">
                            <span class="vocab-term">GroupBy</span>
                            <span class="vocab-definition">Split-Apply-Combine pattern: split data into groups by column(s), apply aggregation functions, combine results into summary DataFrame.</span>
                        </div>
                        <div class="vocab-item">
                            <span class="vocab-term">NaN</span>
                            <span class="vocab-definition">"Not a Number"‚ÄîPandas representation of missing values. Use <code>isna()</code>, <code>fillna()</code>, <code>dropna()</code> to handle them.</span>
                        </div>
                        <div class="vocab-item">
                            <span class="vocab-term">Vectorized Operations</span>
                            <span class="vocab-definition">Operations applied to entire columns at once (not loops). Fast because Pandas uses optimized C/NumPy code under the hood.</span>
                        </div>
                        <div class="vocab-item">
                            <span class="vocab-term">Method Chaining</span>
                            <span class="vocab-definition">Calling multiple DataFrame methods in sequence (e.g., <code>df.dropna().groupby('col').mean()</code>). Creates readable pipelines.</span>
                        </div>
                    </div>
                </div>

                <div class="concept-grid">
                    <div class="concept-card">
                        <h3>üîó Merging & Joining</h3>
                        <p>Combine DataFrames using <code>merge()</code> and <code>concat()</code>. Essential for integrating data from multiple sources (like SQL joins).</p>
                    </div>
                    <div class="concept-card">
                        <h3>üìä GroupBy Aggregations</h3>
                        <p>Use <code>groupby()</code> to split data by categories, apply functions (sum, mean, count), and create summary statistics.</p>
                    </div>
                    <div class="concept-card">
                        <h3>üßπ Handling Missing Data</h3>
                        <p>Detect and handle NaN values with <code>isna()</code>, <code>fillna()</code>, and <code>dropna()</code>. Critical for clean datasets.</p>
                    </div>
                    <div class="concept-card">
                        <h3>üî§ String Operations</h3>
                        <p>Clean text data with vectorized <code>.str</code> methods‚Äîsplit, strip, replace, extract patterns‚Äîno loops needed.</p>
                    </div>
                </div>

                <div class="analogy-box">
                    <div class="analogy-title">üéØ Analogy: Pandas Advanced = Kitchen Tools</div>
                    <p><strong>Merge:</strong> Like combining ingredients from two separate recipe cards (left card + right card) based on matching ingredient names.</p>
                    <p><strong>Concat:</strong> Stacking two trays of cookies on top of each other‚Äîsimple vertical/horizontal combination without matching.</p>
                    <p><strong>GroupBy:</strong> Sorting produce into bins (apples, oranges, bananas), then weighing each bin to get total weight per fruit type.</p>
                    <p><strong>NaN (Missing Data):</strong> Empty slots in your ingredient list. You can fill them (buy more), drop them (skip recipe), or leave them empty.</p>
                    <p><strong>String Methods:</strong> A label maker that cleans messy handwritten labels‚Äîtrim spaces, capitalize, fix typos‚Äîautomatically on all jars at once.</p>
                    <p><strong>Method Chaining:</strong> A conveyor belt where each station performs one task (wash ‚Üí peel ‚Üí chop ‚Üí cook) in sequence.</p>
                </div>

                <div class="explanation-box info">
                    <div class="explanation-title">üí° 80/20 Rule</div>
                    <p>Data Scientists spend 80% of their time cleaning and preparing data, and only 20% analyzing it. Mastering these tools makes you efficient.</p>
                    <p><strong>Real-World Applications:</strong></p>
                    <ul>
                        <li><strong>E-commerce:</strong> Merge customer data with order data to analyze purchasing behavior per demographic</li>
                        <li><strong>Finance:</strong> GroupBy transactions by account to calculate monthly spending per category</li>
                        <li><strong>Healthcare:</strong> Fill missing patient vitals using forward-fill or mean imputation strategies</li>
                        <li><strong>Marketing:</strong> Clean messy email addresses (trim whitespace, lowercase) before deduplication</li>
                    </ul>
                </div>

                <div class="explanation-box">
                    <div class="explanation-title">üí° Learning Strategy: Advanced Pandas</div>
                    <p><strong>Master GroupBy First:</strong> It's the most powerful and confusing concept. Practice split-apply-combine until it clicks.</p>
                    <p><strong>Use Method Chaining:</strong> Chain operations for readable pipelines: <code>df.dropna().groupby('col').mean()</code> tells a data story.</p>
                    <p><strong>Understand Join Types:</strong> Draw Venn diagrams for inner, left, right, outer joins. Visualize what rows survive each merge type.</p>
                    <p><strong>Don't Loop‚ÄîVectorize:</strong> If you're using <code>for row in df.iterrows()</code>, there's always a vectorized alternative. Ask yourself "How can Pandas do this in one line?"</p>
                    <p><strong>Test on Small Data First:</strong> Before running expensive operations (merge, groupby), test logic on <code>df.head(100)</code> to catch bugs fast.</p>
                </div>

                <button class="nav-btn complete-btn" data-topic="intro">Mark Complete ‚úì</button>
                <div class="nav-buttons">
                    <button class="nav-btn" disabled>‚óÄ Previous</button>
                    <button class="nav-btn next" onclick="navigateToSection('merging')">Next: Merging ‚ñ∂</button>
                </div>
            </section>

            <!-- MERGING -->
            <section id="merging" class="section">
                <h2>üîó Merging & Joining</h2>
                <p>Combining data from different sources is a fundamental skill.</p>

                <div class="skill-progression">
                    <div class="skill-tabs">
                        <button class="skill-tab active" data-level="bad" data-target="merge-bad">
                            <span class="skill-tab-icon">üî¥</span> Bad
                        </button>
                        <button class="skill-tab" data-level="novice" data-target="merge-novice">
                            <span class="skill-tab-icon">üü†</span> Novice
                        </button>
                        <button class="skill-tab" data-level="best" data-target="merge-best">
                            <span class="skill-tab-icon">üü¢</span> Best Practice
                        </button>
                    </div>

                    <!-- BAD -->
                    <div class="skill-content active" id="merge-bad">
                        <div class="code-container level-bad">
                            <div class="code-header">
                                <div class="code-header-left">
                                    <span class="code-label">Python</span>
                                    <span class="level-badge bad">‚ùå Bad Practice</span>
                                    <span class="semantic-label">Manual Loops</span>
                                </div>
                                <button class="run-button" data-output="{'Alice': 'HR', 'Bob': 'Engineering'}">Run ‚ñ∂</button>
                            </div>
<pre><code><span class="comment"># ‚ùå BAD: Looping to match data</span>
users = [{<span class="string">'id'</span>: <span class="number">1</span>, <span class="string">'name'</span>: <span class="string">'Alice'</span>}, {<span class="string">'id'</span>: <span class="number">2</span>, <span class="string">'name'</span>: <span class="string">'Bob'</span>}]
depts = [{<span class="string">'id'</span>: <span class="number">1</span>, <span class="string">'dept'</span>: <span class="string">'HR'</span>}, {<span class="string">'id'</span>: <span class="number">2</span>, <span class="string">'dept'</span>: <span class="string">'Engineering'</span>}]

result = {}
<span class="keyword">for</span> u <span class="keyword">in</span> users:
    <span class="keyword">for</span> d <span class="keyword">in</span> depts:
        <span class="keyword">if</span> u[<span class="string">'id'</span>] == d[<span class="string">'id'</span>]:
            result[u[<span class="string">'name'</span>]] = d[<span class="string">'dept'</span>]

<span class="keyword">print</span>(result)
<span class="comment"># Very slow O(N*M) complexity!</span>
</code></pre>
                        </div>
                    </div>

                    <!-- NOVICE -->
                    <div class="skill-content" id="merge-novice">
                        <div class="code-container level-novice">
                            <div class="code-header">
                                <div class="code-header-left">
                                    <span class="code-label">Python</span>
                                    <span class="level-badge novice">üî∞ Novice</span>
                                    <span class="semantic-label">Basic Merge</span>
                                </div>
                                <button class="run-button" data-output="   id   name         dept\n0   1  Alice           HR\n1   2    Bob  Engineering">Run ‚ñ∂</button>
                            </div>
<pre><code><span class="comment"># üî∞ NOVICE: Simple inner merge</span>
<span class="keyword">import</span> pandas <span class="keyword">as</span> pd

users = pd.DataFrame({<span class="string">'id'</span>: [<span class="number">1</span>, <span class="number">2</span>], <span class="string">'name'</span>: [<span class="string">'Alice'</span>, <span class="string">'Bob'</span>]})
depts = pd.DataFrame({<span class="string">'id'</span>: [<span class="number">1</span>, <span class="number">2</span>], <span class="string">'dept'</span>: [<span class="string">'HR'</span>, <span class="string">'Engineering'</span>]})

<span class="comment"># Merge on 'id' column</span>
merged = pd.merge(users, depts, on=<span class="string">'id'</span>)
<span class="keyword">print</span>(merged)
</code></pre>
                        </div>
                    </div>

                    <!-- BEST -->
                    <div class="skill-content" id="merge-best">
                        <div class="code-container level-best">
                            <div class="code-header">
                                <div class="code-header-left">
                                    <span class="code-label">Python</span>
                                    <span class="level-badge best">‚≠ê Best Practice</span>
                                    <span class="semantic-label">Explicit Joins</span>
                                </div>
                                <button class="run-button" data-output="   id   name         dept\n0   1  Alice           HR\n1   2    Bob  Engineering\n2   3  Carol          NaN">Run ‚ñ∂</button>
                            </div>
<pre><code><span class="comment"># ‚≠ê BEST PRACTICE: Controlling join type</span>
<span class="keyword">import</span> pandas <span class="keyword">as</span> pd

users = pd.DataFrame({<span class="string">'id'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="string">'name'</span>: [<span class="string">'Alice'</span>, <span class="string">'Bob'</span>, <span class="string">'Carol'</span>]})
depts = pd.DataFrame({<span class="string">'id'</span>: [<span class="number">1</span>, <span class="number">2</span>], <span class="string">'dept'</span>: [<span class="string">'HR'</span>, <span class="string">'Engineering'</span>]})

<span class="comment"># 'how' parameter controls behavior:</span>
<span class="comment"># 'inner' (default): Intersection</span>
<span class="comment"># 'left': Keep all users, fill missing depts with NaN</span>
<span class="comment"># 'outer': Union of both</span>
merged = pd.merge(users, depts, on=<span class="string">'id'</span>, how=<span class="string">'left'</span>)

<span class="keyword">print</span>(merged)
<span class="comment"># Note: Carol has NaN department because id=3 isn't in depts</span>
</code></pre>
                        </div>
                    </div>
                </div>

                <div class="warning-box">
                    <div class="warning-title">‚ö†Ô∏è Common Pitfalls: Merging</div>
                    <ul>
                        <li><strong>Forgetting Join Type:</strong> Default <code>merge()</code> is inner join, which drops unmatched rows. Explicitly set <code>how='left'</code> or <code>how='outer'</code> to avoid silent data loss.</li>
                        <li><strong>Duplicate Keys:</strong> If the key column has duplicates in both DataFrames, the result explodes (Cartesian product). Check for duplicates before merging.</li>
                        <li><strong>Column Name Collisions:</strong> Merging creates <code>_x</code> and <code>_y</code> suffixes for duplicate column names. Use <code>suffixes=('_left', '_right')</code> for clarity.</li>
                        <li><strong>Ignoring Index:</strong> <code>concat()</code> preserves indexes by default, causing duplicate index values. Set <code>ignore_index=True</code> to reset to 0, 1, 2...</li>
                    </ul>
                </div>

                <div class="discussion-box">
                    <div class="discussion-title">üí¨ Discussion Questions</div>
                    <ol>
                        <li>What's the difference between <code>merge()</code> and <code>join()</code>? When would you use each?</li>
                        <li>How does an outer join differ from a union in SQL? What does Pandas do with unmatched rows?</li>
                        <li>Why is it important to validate data before merging (e.g., checking for duplicate keys)?</li>
                        <li>When would you use <code>concat()</code> instead of <code>merge()</code>? Give examples of scenarios for each.</li>
                    </ol>
                </div>

                <button class="nav-btn complete-btn" data-topic="merging">Mark Topic Complete ‚úì</button>
                <div class="nav-buttons">
                    <button class="nav-btn prev" onclick="navigateToSection('intro')">‚óÄ Prev: Intro</button>
                    <button class="nav-btn next" onclick="navigateToSection('groupby')">Next: GroupBy ‚ñ∂</button>
                </div>
            </section>

            <!-- GROUPBY -->
            <section id="groupby" class="section">
                <h2>üì¶ Grouping & Aggregation</h2>
                <p>Split data into groups, apply a function, and combine results (Split-Apply-Combine).</p>

                <div class="code-container level-best">
                    <div class="code-header">
                        <span class="code-label">Python</span>
                        <span class="level-badge best">‚≠ê Powerful Aggregation</span>
                    </div>
                    <button class="run-button" data-output="        salary\n          mean     max\ndept\nEng      85000   90000\nHR       60000   60000">Run ‚ñ∂</button>
<pre><code><span class="keyword">import</span> pandas <span class="keyword">as</span> pd

df = pd.DataFrame({
    <span class="string">'dept'</span>: [<span class="string">'HR'</span>, <span class="string">'Eng'</span>, <span class="string">'Eng'</span>, <span class="string">'HR'</span>, <span class="string">'Eng'</span>],
    <span class="string">'salary'</span>: [<span class="number">60000</span>, <span class="number">80000</span>, <span class="number">90000</span>, <span class="number">60000</span>, <span class="number">85000</span>],
    <span class="string">'age'</span>: [<span class="number">25</span>, <span class="number">30</span>, <span class="number">35</span>, <span class="number">22</span>, <span class="number">28</span>]
})

<span class="comment"># Group by Department and calculate multiple stats</span>
summary = df.groupby(<span class="string">'dept'</span>).agg({
    <span class="string">'salary'</span>: [<span class="string">'mean'</span>, <span class="string">'max'</span>]
})

<span class="keyword">print</span>(summary)
</code></pre>
                </div>

                <div class="warning-box">
                    <div class="warning-title">‚ö†Ô∏è Common Pitfalls: GroupBy</div>
                    <ul>
                        <li><strong>Forgetting to Aggregate:</strong> <code>df.groupby('col')</code> returns a GroupBy object, not a DataFrame. You must call <code>.mean()</code>, <code>.sum()</code>, etc., to get results.</li>
                        <li><strong>Lost Columns:</strong> Aggregation functions only work on numeric columns by default. Non-numeric columns are silently dropped unless explicitly handled.</li>
                        <li><strong>Confusing agg() Syntax:</strong> <code>.agg({'col': ['mean', 'max']})</code> creates multi-level columns. Use <code>.agg({'col': 'mean'})</code> for single-level or <code>.reset_index()</code> to flatten.</li>
                        <li><strong>Index Confusion:</strong> GroupBy results have the grouped column(s) as the index. Use <code>.reset_index()</code> to move them back to regular columns.</li>
                    </ul>
                </div>

                <div class="discussion-box">
                    <div class="discussion-title">üí¨ Discussion Questions</div>
                    <ol>
                        <li>What does "Split-Apply-Combine" mean in the context of GroupBy? Give a real-world example.</li>
                        <li>How does <code>df.groupby('col').mean()</code> differ from <code>df['col'].mean()</code>?</li>
                        <li>When would you use <code>.agg()</code> with a dictionary vs. a single function? What are the trade-offs?</li>
                        <li>Why does GroupBy create a grouped index? When would you want to keep it vs. reset it?</li>
                    </ol>
                </div>

                <button class="nav-btn complete-btn" data-topic="groupby">Mark Topic Complete ‚úì</button>
                <div class="nav-buttons">
                    <button class="nav-btn prev" onclick="navigateToSection('merging')">‚óÄ Prev: Merging</button>
                    <button class="nav-btn next" onclick="navigateToSection('missing')">Next: Missing Data ‚ñ∂</button>
                </div>
            </section>

            <!-- MISSING DATA -->
            <section id="missing" class="section">
                <h2>‚ùì Handling Missing Data</h2>
                <p>Real data is messy. Pandas uses <code>NaN</code> (Not a Number) to represent missing values.</p>

                <div class="skill-progression">
                    <div class="skill-tabs">
                        <button class="skill-tab active" data-level="novice" data-target="miss-novice">
                            <span class="skill-tab-icon">üü†</span> Novice
                        </button>
                        <button class="skill-tab" data-level="best" data-target="miss-best">
                            <span class="skill-tab-icon">üü¢</span> Best Practice
                        </button>
                    </div>

                    <!-- NOVICE -->
                    <div class="skill-content active" id="miss-novice">
                        <div class="code-container level-novice">
                            <div class="code-header">
                                <div class="code-header-left">
                                    <span class="code-label">Python</span>
                                    <span class="level-badge novice">üî∞ Novice</span>
                                    <span class="semantic-label">Drop NA</span>
                                </div>
                                <button class="run-button" data-output="   A    B\n0  1  5.0">Run ‚ñ∂</button>
                            </div>
<pre><code><span class="comment"># üî∞ NOVICE: Just deleting missing rows</span>
<span class="keyword">import</span> pandas <span class="keyword">as</span> pd
<span class="keyword">import</span> numpy <span class="keyword">as</span> np

df = pd.DataFrame({
    <span class="string">'A'</span>: [<span class="number">1</span>, <span class="number">2</span>, np.nan],
    <span class="string">'B'</span>: [<span class="number">5</span>, np.nan, np.nan]
})

<span class="comment"># Drops ANY row containing NaN</span>
clean = df.dropna()
<span class="keyword">print</span>(clean)
<span class="comment"># Result: Only row 0 remains. We lost data!</span>
</code></pre>
                        </div>
                    </div>

                    <!-- BEST -->
                    <div class="skill-content" id="miss-best">
                        <div class="code-container level-best">
                            <div class="code-header">
                                <div class="code-header-left">
                                    <span class="code-label">Python</span>
                                    <span class="level-badge best">‚≠ê Best Practice</span>
                                    <span class="semantic-label">Smart Filling</span>
                                </div>
                                <button class="run-button" data-output="     A    B\n0  1.0  5.0\n1  2.0  5.0\n2  1.5  0.0">Run ‚ñ∂</button>
                            </div>
<pre><code><span class="comment"># ‚≠ê BEST PRACTICE: Imputation strategies</span>
<span class="keyword">import</span> pandas <span class="keyword">as</span> pd
<span class="keyword">import</span> numpy <span class="keyword">as</span> np

df = pd.DataFrame({
    <span class="string">'A'</span>: [<span class="number">1</span>, <span class="number">2</span>, np.nan],
    <span class="string">'B'</span>: [<span class="number">5</span>, np.nan, np.nan]
})

<span class="comment"># Fill A with mean of A</span>
df[<span class="string">'A'</span>] = df[<span class="string">'A'</span>].fillna(df[<span class="string">'A'</span>].mean())

<span class="comment"># Fill B with specific value (e.g., 0)</span>
df[<span class="string">'B'</span>] = df[<span class="string">'B'</span>].fillna(<span class="number">0</span>)

<span class="keyword">print</span>(df)
</code></pre>
                        </div>
                    </div>
                </div>

                <div class="warning-box">
                    <div class="warning-title">‚ö†Ô∏è Common Pitfalls: Missing Data</div>
                    <ul>
                        <li><strong>Not Checking for NaN:</strong> Forgetting to check <code>df.isna().sum()</code> before analysis causes silent errors (NaN propagates through calculations).</li>
                        <li><strong>Dropping Too Much Data:</strong> <code>dropna()</code> without parameters drops any row with any NaN. Use <code>subset=['col']</code> or <code>thresh=n</code> to be selective.</li>
                        <li><strong>Blind Imputation:</strong> Filling NaN with mean/median/mode without understanding why data is missing can introduce bias. Always investigate the cause first.</li>
                        <li><strong>Overwriting Original Data:</strong> <code>fillna()</code> and <code>dropna()</code> don't modify in-place by default. Assign result back: <code>df = df.dropna()</code> or use <code>inplace=True</code>.</li>
                    </ul>
                </div>

                <div class="discussion-box">
                    <div class="discussion-title">üí¨ Discussion Questions</div>
                    <ol>
                        <li>What are the three main strategies for handling missing data (drop, fill, predict)? When is each appropriate?</li>
                        <li>Why is filling NaN with the mean sometimes a bad idea? What assumptions does it make about your data?</li>
                        <li>How does forward-fill (<code>ffill()</code>) differ from backward-fill (<code>bfill()</code>)? When would you use each?</li>
                        <li>What ethical considerations arise when imputing missing data in healthcare or financial datasets?</li>
                    </ol>
                </div>

                <button class="nav-btn complete-btn" data-topic="missing">Mark Topic Complete ‚úì</button>
                <div class="nav-buttons">
                    <button class="nav-btn prev" onclick="navigateToSection('groupby')">‚óÄ Prev: GroupBy</button>
                    <button class="nav-btn next" onclick="navigateToSection('strings')">Next: Strings ‚ñ∂</button>
                </div>
            </section>

            <!-- STRINGS -->
            <section id="strings" class="section">
                <h2>üßµ String Operations</h2>
                <p>Pandas has a special <code>.str</code> accessor for vectorized string manipulation.</p>

                <div class="code-container level-best">
                    <div class="code-header">
                        <span class="code-label">Python</span>
                        <span class="level-badge best">‚≠ê Vectorized Strings</span>
                    </div>
                    <button class="run-button" data-output="0      alice\n1        BOB\n2    CHARLIE\nName: name, dtype: object">Run ‚ñ∂</button>
<pre><code><span class="keyword">import</span> pandas <span class="keyword">as</span> pd

df = pd.DataFrame({
    <span class="string">'name'</span>: [<span class="string">' Alice '</span>, <span class="string">'Bob'</span>, <span class="string">'charlie'</span>],
    <span class="string">'email'</span>: [<span class="string">'alice@test.com'</span>, <span class="string">'bob@gmail.com'</span>, <span class="string">'char@test.com'</span>]
})

<span class="comment"># Chain operations: strip whitespace -> upper case</span>
df[<span class="string">'name'</span>] = df[<span class="string">'name'</span>].str.strip().str.upper()

<span class="comment"># Filter by string contains</span>
gmail_users = df[df[<span class="string">'email'</span>].str.contains(<span class="string">'gmail'</span>)]

<span class="keyword">print</span>(df[<span class="string">'name'</span>])
</code></pre>
                </div>

                <div class="warning-box">
                    <div class="warning-title">‚ö†Ô∏è Common Pitfalls: String Operations</div>
                    <ul>
                        <li><strong>Using Loops Instead of .str:</strong> Never loop through rows for string operations. <code>df['col'].str.lower()</code> is 100x faster than <code>apply(lambda x: x.lower())</code>.</li>
                        <li><strong>NaN Breaks String Methods:</strong> <code>.str</code> methods fail on NaN values. Use <code>df['col'].fillna('').str.method()</code> or <code>.str.method(na=False)</code> to handle missing data.</li>
                        <li><strong>Regex Confusion:</strong> <code>.str.contains()</code> uses regex by default. To search for literal special characters like <code>.</code> or <code>$</code>, set <code>regex=False</code>.</li>
                        <li><strong>Not Chaining .str Methods:</strong> You can chain multiple operations: <code>df['col'].str.strip().str.lower().str.replace(' ', '_')</code>. Use it for readable pipelines.</li>
                    </ul>
                </div>

                <div class="discussion-box">
                    <div class="discussion-title">üí¨ Discussion Questions</div>
                    <ol>
                        <li>Why are vectorized string operations (.str) faster than loops? What happens under the hood?</li>
                        <li>When would you use <code>.str.extract()</code> vs. <code>.str.split()</code> for parsing structured text data?</li>
                        <li>How can you use <code>.str.contains()</code> with regex to filter emails by domain (e.g., all gmail.com addresses)?</li>
                        <li>What strategies can you use to clean messy address data (extra spaces, inconsistent capitalization, special characters)?</li>
                    </ol>
                </div>

                <div class="playground">
                    <div class="playground-title">üéÆ Practice Playground: Email Cleaner</div>
                    <p><strong>Challenge:</strong> Given a DataFrame with a messy <code>email</code> column:</p>
                    <ul>
                        <li>Remove leading/trailing whitespace</li>
                        <li>Convert all emails to lowercase</li>
                        <li>Extract domain names (everything after @) into a new column</li>
                        <li>Filter rows where domain is "gmail.com"</li>
                        <li>Flag invalid emails (no @ symbol) with a boolean column</li>
                    </ul>
                    <p><strong>Bonus:</strong> Use method chaining to do all operations in one line.</p>
                </div>

                <button class="nav-btn complete-btn" data-topic="strings">Mark Topic Complete ‚úì</button>
                <div class="nav-buttons">
                    <button class="nav-btn prev" onclick="navigateToSection('missing')">‚óÄ Prev: Missing</button>
                    <button class="nav-btn next" onclick="navigateToSection('cheatsheet')">Next: Cheat Sheet ‚ñ∂</button>
                </div>
            </section>

            <!-- CHEAT SHEET -->
            <section id="cheatsheet" class="section">
                <h2>üìú Advanced Pandas Cheat Sheet</h2>
                
                <div class="code-container level-best">
                    <div class="code-header">
                        <span class="code-label">Patterns</span>
                        <span class="level-badge best">Reference</span>
                    </div>
<pre><code><span class="comment"># ‚ïê‚ïê‚ïê MERGING ‚ïê‚ïê‚ïê</span>
pd.merge(df1, df2, on=<span class="string">'id'</span>, how=<span class="string">'inner'</span>)
pd.concat([df1, df2])  <span class="comment"># Stack vertically</span>

<span class="comment"># ‚ïê‚ïê‚ïê GROUPBY ‚ïê‚ïê‚ïê</span>
df.groupby(<span class="string">'col'</span>).mean()
df.groupby(<span class="string">'col'</span>).agg({<span class="string">'val'</span>: [<span class="string">'min'</span>, <span class="string">'max'</span>]})

<span class="comment"># ‚ïê‚ïê‚ïê MISSING DATA ‚ïê‚ïê‚ïê</span>
df.isna().sum()        <span class="comment"># Count missing</span>
df.dropna()            <span class="comment"># Drop rows</span>
df.fillna(value)       <span class="comment"># Fill missing</span>

<span class="comment"># ‚ïê‚ïê‚ïê STRINGS ‚ïê‚ïê‚ïê</span>
df[<span class="string">'s'</span>].str.lower()
df[<span class="string">'s'</span>].str.contains(<span class="string">'pattern'</span>)
df[<span class="string">'s'</span>].str.replace(<span class="string">'old'</span>, <span class="string">'new'</span>)
</code></pre>
                </div>

                <div class="objectives-box" style="margin-top: 2rem;">
                    <div class="objectives-title">üéØ Key Takeaways: Advanced Pandas</div>
                    <ul>
                        <li><strong>Master Merge Types:</strong> Understand inner, left, right, outer joins. Default is inner‚Äîexplicitly set <code>how=</code> to avoid silent data loss.</li>
                        <li><strong>GroupBy = Split-Apply-Combine:</strong> Split data by groups, apply aggregation functions, combine results. Essential for summary statistics.</li>
                        <li><strong>Check for NaN First:</strong> Use <code>df.isna().sum()</code> before analysis. NaN values propagate through calculations and break visualizations.</li>
                        <li><strong>Choose Imputation Wisely:</strong> Filling NaN with mean/median/mode can introduce bias. Understand why data is missing before filling.</li>
                        <li><strong>Vectorize String Operations:</strong> Never loop for string cleaning. Use <code>.str</code> methods‚Äîthey're 100x faster and handle NaN gracefully.</li>
                        <li><strong>Method Chaining for Readability:</strong> Chain operations to create readable pipelines: <code>df.dropna().groupby('col').mean().reset_index()</code>.</li>
                        <li><strong>Reset Index After GroupBy:</strong> GroupBy results have grouped column(s) as index. Use <code>.reset_index()</code> to move them back to columns.</li>
                        <li><strong>Test on Small Data First:</strong> Before expensive operations (merge, groupby), test logic on <code>df.head(100)</code> to catch bugs quickly.</li>
                    </ul>
                </div>

                <button class="nav-btn complete-btn" data-topic="cheatsheet">Mark Lesson Complete üéâ</button>
                <div class="nav-buttons">
                    <button class="nav-btn prev" onclick="navigateToSection('strings')">‚óÄ Prev: Strings</button>
                    <button class="nav-btn next" disabled>üèÜ Lesson Complete!</button>
                </div>
            </section>
        </main>
    </div>

    <div class="achievement" id="achievement">
        <div class="achievement-icon">üßπ</div>
        <div class="achievement-title">Achievement Unlocked!</div>
        <p>You're a Data Janitor! (That's a compliment in Data Science).</p>
    </div>

    <script>
        const sectionsOrder = ['intro', 'merging', 'groupby', 'missing', 'strings', 'cheatsheet'];
        const totalTopics = 5; 
        
        const progressBar = document.getElementById('progressBar');
        const xpFill = document.getElementById('xpFill');
        const xpText = document.getElementById('xpText');
        const achievement = document.getElementById('achievement');
        const completed = new Set();

        function navigateToSection(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            const target = document.getElementById(id);
            if (target) target.classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            const nav = document.querySelector(`.nav-item[data-section="${id}"]`);
            if (nav) nav.classList.add('active');
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => navigateToSection(item.dataset.section));
        });

        function updateXP() {
            const percent = (completed.size / totalTopics) * 100;
            xpFill.style.width = percent + '%';
            xpText.textContent = `${completed.size} / ${totalTopics} Topics`;
            
            if (completed.size === totalTopics) {
                achievement.classList.add('show');
                setTimeout(() => achievement.classList.remove('show'), 6000);
            }
        }

        document.querySelectorAll('.complete-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const topic = btn.dataset.topic;
                if (!completed.has(topic)) {
                    completed.add(topic);
                    const item = document.querySelector(`.nav-item[data-section="${topic}"]`);
                    if (item) item.classList.add('completed');
                    btn.textContent = 'Completed ‚úì';
                    btn.disabled = true;
                    updateXP();
                }
            });
        });

        document.querySelectorAll('.run-button').forEach(btn => {
            btn.addEventListener('click', () => {
                const container = btn.closest('.code-container');
                let out = container.querySelector('.output');
                if (!out) {
                    out = document.createElement('div');
                    out.className = 'output';
                    container.appendChild(out);
                }
                out.innerHTML = '<div class="output-label">Output:</div>' + 
                               (btn.dataset.output || 'No output').replace(/\n/g, '<br>');
                out.classList.add('show');
                btn.disabled = true;
                btn.innerHTML = '‚úî Ran';
            });
        });

        document.querySelectorAll('.skill-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const progression = tab.closest('.skill-progression');
                const targetId = tab.dataset.target;
                progression.querySelectorAll('.skill-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                progression.querySelectorAll('.skill-content').forEach(content => {
                    content.classList.remove('active');
                });
                const targetContent = document.getElementById(targetId);
                if (targetContent) targetContent.classList.add('active');
            });
        });

        window.addEventListener('scroll', () => {
            const doc = document.documentElement;
            const scrolled = doc.scrollTop || document.body.scrollTop;
            const height = (doc.scrollHeight - doc.clientHeight) || 1;
            const percent = (scrolled / height) * 100;
            progressBar.style.width = percent + '%';
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === 'ArrowLeft') {
                const activeSection = document.querySelector('.section.active');
                if (!activeSection) return;
                const currentIndex = sectionsOrder.indexOf(activeSection.id);
                let newIndex;
                if (e.key === 'ArrowRight' && currentIndex < sectionsOrder.length - 1) newIndex = currentIndex + 1;
                else if (e.key === 'ArrowLeft' && currentIndex > 0) newIndex = currentIndex - 1;
                if (newIndex !== undefined) navigateToSection(sectionsOrder[newIndex]);
            }
        });

        console.log('üêº Week 8: Advanced Pandas Loaded!');
    </script>

    <footer class="sd-footer">
            
            <div class="sd-credits">
            Enhanced curriculum for the Returned Citizen community by <a href="https://www.straydog-syndications-llc.com/" target="_blank" rel="noopener">StrayDog Syndications LLC</a>
        </div>
        <div class="sd-links">
            <a href="https://github.com/StrayDogSyn/Python-Essentials-Code-The-Dream" target="_blank" rel="noopener" aria-label="View on GitHub">
                <svg class="sd-github" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg>
            </a>
        </div>
    </footer>

</body>
</html>
